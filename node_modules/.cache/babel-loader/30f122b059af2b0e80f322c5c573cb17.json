{"ast":null,"code":"var _jsxFileName = \"D:\\\\eduexcellence-dev\\\\src\\\\containers\\\\admin\\\\course\\\\new\\\\components\\\\curriculum.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { connect } from 'react-redux';\nimport AddChapter from \"./addchapter\";\nimport Lodaing from \"../../../../common/loading\";\nimport NoData from \"../../../../common/nodata\";\nimport { getList, createData, updateChapter, saveResourceFile, saveChapterImgFile, deleteChapter } from \"../../actions\";\n\nconst Curricum = props => {\n  const [open, setNew] = useState(false);\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [item, setItem] = useState(null);\n  useEffect(() => {\n    getData();\n  }, []);\n\n  const getData = () => {\n    if (props.course) {\n      getList(`chapters?courseid=${props.course._id}`).then(res => {\n        setData(res);\n        setLoading(false);\n      }).catch(err => {\n        setLoading(false);\n      });\n    } else {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = (obj, resources, chaperImage) => {\n    if (props.course) {\n      obj['courseid'] = props.course._id;\n      setLoading(true);\n\n      if (item) {\n        updateChapter(item._id, obj).then(res => {\n          if (resources !== null || chaperImage !== null) {\n            saveResources(resources, chaperImage, res._id);\n          } else {\n            setNew(false);\n            setLoading(false);\n\n            let _data = data.filter(i => i._id !== item._id);\n\n            setData([..._data, res]);\n          }\n        }).catch(err => {\n          setLoading(false);\n        });\n      } else {\n        createData(\"chapters\", obj).then(res => {\n          if (resources !== null || chaperImage !== null) {\n            saveResources(resources, chaperImage, res._id);\n          } else {\n            setNew(false);\n            setLoading(false);\n            setData(prevState => [...prevState, res]);\n          }\n        }).catch(err => {\n          setLoading(false);\n        });\n      }\n    } else {\n      alert(\"Create Course First\");\n      props.setTab('basic');\n    }\n  };\n\n  const addNew = () => {\n    if (props.course) {\n      setItem(null);\n      setNew(!open);\n    } else {\n      alert(\"Create Course First\");\n      props.setTab('basic');\n    }\n  };\n\n  const handleEdit = item => {\n    setItem(item);\n    setNew(true);\n  };\n\n  const handleDelete = item => {\n    var r = window.confirm(\"Do You want to delete the chapter :: \" + item.title);\n\n    if (r == true) {\n      deleteChapter(item._id).then(res => {\n        let _data = data.filter(i => i._id !== item._id);\n\n        setData([..._data]);\n      }).catch(err => {\n        console.log(\"err in delete chapter === \", err);\n      });\n    }\n  };\n\n  const saveResources = (resources, chaperImage, id) => {\n    let promises = [];\n\n    if (resources !== null) {\n      for (let i = 0; i < resources.length; i++) {\n        promises.push(saveResourceFile(resources[i], id));\n      }\n    }\n\n    if (chaperImage !== null) {\n      promises.push(saveChapterImgFile(chaperImage, id));\n    }\n\n    Promise.all(promises).then(res => {\n      getData();\n      setNew(false);\n      setLoading(false);\n    }).catch(err => {\n      setLoading(false);\n    });\n  };\n\n  console.log(data);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tabdb active\",\n    \"data-tab\": \"#curriculum\",\n    style: {\n      \"padding\": \"0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 12\n    }\n  }, loading && /*#__PURE__*/React.createElement(Lodaing, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"curriculum-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, data && data.length > 0 ? /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 29\n    }\n  }, \"Title\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 29\n    }\n  }, \"Mode\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 29\n    }\n  }, \"Source/Venue\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 29\n    }\n  }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    id: \"myTable\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  }, data.map(item => /*#__PURE__*/React.createElement(\"tr\", {\n    key: item._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 33\n    }\n  }, item.title), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 33\n    }\n  }, item.mode), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 33\n    }\n  }, item.source), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 33\n    }\n  }, item.description), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-eye\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-pencil\",\n    onClick: () => handleEdit(item),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-trash\",\n    onClick: () => handleDelete(item),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 37\n    }\n  })))))) : /*#__PURE__*/React.createElement(NoData, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"addchap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => addNew(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 20\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-plus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 53\n    }\n  }), \" Add chapter\"))), open && /*#__PURE__*/React.createElement(AddChapter, {\n    saveCallback: handleSave,\n    item: item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 22\n    }\n  })));\n};\n\nconst mapStateToProps = state => {\n  return {\n    course: state.admincourse.courseData\n  };\n};\n\nexport default connect(mapStateToProps)(Curricum);","map":{"version":3,"sources":["D:/eduexcellence-dev/src/containers/admin/course/new/components/curriculum.js"],"names":["React","useState","useEffect","connect","AddChapter","Lodaing","NoData","getList","createData","updateChapter","saveResourceFile","saveChapterImgFile","deleteChapter","Curricum","props","open","setNew","data","setData","loading","setLoading","item","setItem","getData","course","_id","then","res","catch","err","handleSave","obj","resources","chaperImage","saveResources","_data","filter","i","prevState","alert","setTab","addNew","handleEdit","handleDelete","r","window","confirm","title","console","log","id","promises","length","push","Promise","all","map","mode","source","description","mapStateToProps","state","admincourse","courseData"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { connect } from 'react-redux'\r\nimport AddChapter from \"./addchapter\";\r\nimport Lodaing from \"../../../../common/loading\";\r\nimport NoData from \"../../../../common/nodata\";\r\nimport { getList, createData, updateChapter, saveResourceFile, saveChapterImgFile, deleteChapter } from \"../../actions\";\r\n\r\nconst Curricum = (props) => {\r\n    const [open, setNew] = useState(false);\r\n    const [data, setData] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [item, setItem] = useState(null);\r\n\r\n    useEffect(() => {\r\n        getData();\r\n    }, [])\r\n\r\n    const getData = () => {\r\n        if (props.course) {\r\n            getList(`chapters?courseid=${props.course._id}`).then(res => {\r\n                setData(res);\r\n                setLoading(false)\r\n            }).catch(err => {\r\n                setLoading(false)\r\n            })\r\n        } else {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const handleSave = (obj, resources, chaperImage) => {\r\n        if (props.course) {\r\n            obj['courseid'] = props.course._id\r\n            setLoading(true);\r\n            if (item) {\r\n                updateChapter(item._id, obj).then(res => {\r\n                    if (resources !== null || chaperImage !== null) {\r\n                        saveResources(resources, chaperImage, res._id);\r\n                    } else {\r\n                        setNew(false);\r\n                        setLoading(false);\r\n                        let _data = data.filter(i => i._id !== item._id);\r\n                        setData([..._data, res])\r\n                    }\r\n                }).catch(err => {\r\n                    setLoading(false);\r\n                })\r\n            } else {\r\n                createData(\"chapters\", obj).then(res => {\r\n                    if (resources !== null || chaperImage !== null) {\r\n                        saveResources(resources, chaperImage, res._id);\r\n                    } else {\r\n                        setNew(false);\r\n                        setLoading(false);\r\n                        setData(prevState => [...prevState, res])\r\n                    }\r\n                }).catch(err => {\r\n                    setLoading(false);\r\n                })\r\n            }\r\n        } else {\r\n            alert(\"Create Course First\");\r\n            props.setTab('basic');\r\n        }\r\n    }\r\n\r\n    const addNew = () => {\r\n        if (props.course) {\r\n            setItem(null);\r\n            setNew(!open);\r\n        } else {\r\n            alert(\"Create Course First\");\r\n            props.setTab('basic');\r\n        }\r\n    }\r\n\r\n    const handleEdit = (item) => {\r\n        setItem(item);\r\n        setNew(true);\r\n    }\r\n\r\n    const handleDelete = (item) => {\r\n        var r = window.confirm(\"Do You want to delete the chapter :: \"+ item.title);\r\n        if (r == true) {\r\n            deleteChapter(item._id).then(res => {\r\n                let _data = data.filter(i => i._id !== item._id);\r\n                setData([..._data])\r\n            }).catch(err => {\r\n                console.log(\"err in delete chapter === \", err);\r\n            })\r\n        }\r\n    }\r\n\r\n    const saveResources = (resources, chaperImage, id) => {\r\n        let promises = [];\r\n        if (resources !== null) {\r\n            for (let i = 0; i < resources.length; i++) {\r\n                promises.push(saveResourceFile(resources[i], id));\r\n            }\r\n        }\r\n        if (chaperImage !== null) {\r\n            promises.push(saveChapterImgFile(chaperImage, id));\r\n        }\r\n        Promise.all(promises).then(res => {\r\n            getData();\r\n            setNew(false);\r\n            setLoading(false);\r\n        }).catch(err => {\r\n            setLoading(false);\r\n        });\r\n    }\r\n\r\n    console.log(data);\r\n    return <div className=\"tabdb active\" data-tab=\"#curriculum\" style={{ \"padding\": \"0\" }}>\r\n        {loading && <Lodaing />}\r\n        <div className=\"curriculum-section\">\r\n            {data && data.length > 0 ?\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Title</th>\r\n                            <th>Mode</th>\r\n                            <th>Source/Venue</th>\r\n                            <th>Description</th>\r\n                            <th>Action</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody id=\"myTable\">\r\n                        {data.map(item =>\r\n                            <tr key={item._id}>\r\n                                <td>{item.title}</td>\r\n                                <td>{item.mode}</td>\r\n                                <td>{item.source}</td>\r\n                                <td>{item.description}</td>\r\n                                <td>\r\n                                    <i className=\"fa fa-eye\"></i> \r\n                                    <i className=\"fa fa-pencil\" onClick={() => handleEdit(item)}></i> \r\n                                    <i className=\"fa fa-trash\" onClick={() => handleDelete(item)}></i>\r\n                                </td>\r\n                            </tr>\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n                : <NoData />}\r\n            <div className=\"addchap\">\r\n                <p><button onClick={() => addNew()}><i className=\"fa fa-plus\"></i> Add chapter</button></p>\r\n            </div>\r\n            {open && <AddChapter saveCallback={handleSave} item={item}/>}\r\n        </div>\r\n    </div>\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return { course: state.admincourse.courseData };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps\r\n)(Curricum);"]},"metadata":{},"sourceType":"module"}